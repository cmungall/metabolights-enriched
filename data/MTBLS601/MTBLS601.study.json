{
    "mtblsStudy": {
        "studyStatus": "Public",
        "curationRequest": "MANUAL_CURATION",
        "modifiedTime": "2019-03-26T11:27:01.204000",
        "statusUpdateTime": "2019-03-26T11:27:01.204000",
        "read_access": true,
        "write_access": false,
        "is_curator": false
    },
    "isaInvestigation": {
        "comments": [
            {
                "name": "Created With Configuration",
                "value": "H:\\software\\metabolight\\ISAcreatorMetaboLights\\Configurations\\MetaboLightsConfig20150707"
            },
            {
                "name": "Last Opened With Configuration",
                "value": "MetaboLightsConfig20150707"
            }
        ],
        "identifier": "MTBLS601",
        "title": "Investigation",
        "description": "",
        "submissionDate": "2018-01-18",
        "publicReleaseDate": "2019-03-26",
        "filename": "",
        "people": [],
        "publications": [],
        "ontologySourceReferences": [
            {
                "comments": [],
                "name": "NCBITAXON",
                "file": "http://data.bioontology.org/ontologies/NCBITAXON",
                "version": "2",
                "description": "National Center for Biotechnology Information (NCBI) Organismal Classification"
            },
            {
                "comments": [],
                "name": "BTO",
                "file": "http://data.bioontology.org/ontologies/BTO",
                "version": "22",
                "description": "BRENDA Tissue and Enzyme Source Ontology"
            },
            {
                "comments": [],
                "name": "CHMO",
                "file": "http://data.bioontology.org/ontologies/CHMO",
                "version": "18",
                "description": "Chemical Methods Ontology"
            },
            {
                "comments": [],
                "name": "SWO",
                "file": "http://data.bioontology.org/ontologies/SWO",
                "version": "19",
                "description": "Software Ontology"
            },
            {
                "comments": [],
                "name": "ROLEO",
                "file": "http://data.bioontology.org/ontologies/ROLEO",
                "version": "1",
                "description": "Role Ontology"
            },
            {
                "comments": [],
                "name": "OBI",
                "file": "http://data.bioontology.org/ontologies/OBI",
                "version": "22",
                "description": "Ontology for Biomedical Investigations"
            },
            {
                "comments": [],
                "name": "BIOMODELS",
                "file": "http://data.bioontology.org/ontologies/BIOMODELS",
                "version": "3",
                "description": "BioModels Ontology"
            },
            {
                "comments": [],
                "name": "MS",
                "file": "http://data.bioontology.org/ontologies/MS",
                "version": "86",
                "description": "Mass Spectrometry Ontology"
            },
            {
                "comments": [],
                "name": "ms",
                "file": "http://purl.obolibrary.org/obo/ms.owl",
                "version": "18-03-2019",
                "description": "Terms to describe the sample."
            },
            {
                "comments": [],
                "name": "ensemblglossary",
                "file": "http://purl.obolibrary.org/obo/ensembl-glossary.owl",
                "version": "2019-03-14",
                "description": "Locus where the sequence differs between individuals of the same species"
            },
            {
                "comments": [],
                "name": "EFO",
                "file": "",
                "version": "",
                "description": ""
            },
            {
                "comments": [],
                "name": "",
                "file": "http://purl.obolibrary.org/obo/ncit.owl",
                "version": "18.10e",
                "description": "NCI Thesaurus OBO Edition"
            },
            {
                "comments": [],
                "name": "NCIT",
                "file": "",
                "version": "",
                "description": ""
            }
        ],
        "studies": [
            {
                "comments": [],
                "identifier": "MTBLS601",
                "filename": "s_MTBLS601.txt",
                "title": "Metabolic reaction network-based recursive metabolite annotation for untargeted metabolomics (Aging mouse liver positive mode)",
                "description": "<p>Large-scale metabolite annotation is a challenge in liquid chromatogram-mass spectrometry (LC-MS)-based untargeted metabolomics. Here, we develop a metabolic reaction network (MRN)-based recursive algorithm (MetDNA) that expands metabolite annotations without the need for a comprehensive standard spectral library. MetDNA is based on the rationale that seed metabolites and their reaction-paired neighbors tend to share structural similarities resulting in similar MS2 spectra. MetDNA characterizes initial seed metabolites using a small library of MS2 spectra, and utilizes their experimental MS2 spectra as surrogate spectra to annotate their reaction-paired neighbor metabolites, which subsequently serve as the basis for recursive analysis. Using different LC-MS platforms, data acquisition methods, and biological samples, we showcase the utility and versatility of MetDNA and demonstrate that about 2000 metabolites can cumulatively be annotated from one experiment. Our results demonstrate that MetDNA substantially expands metabolite annotation, enabling quantitative assessment of metabolic pathways and facilitating integrative multi-omics analysis.</p><p><br></p><p><strong>Aging mouse liver positive mode</strong> is reported in <a href='https://www.ebi.ac.uk/metabolights/MTBLS601' rel='noopener noreferrer' target='_blank'><strong>MTBLS601</strong></a>.</p><p><strong>Aging mouse liver negative mode</strong> is reported in <a href='https://www.ebi.ac.uk/metabolights/MTBLS606' rel='noopener noreferrer' target='_blank'><strong>MTBLS606</strong></a>.</p><p><strong>Aging fruit fly positive mode</strong> is reported in <a href='https://www.ebi.ac.uk/metabolights/MTBLS612' rel='noopener noreferrer' target='_blank'><strong>MTBLS612</strong></a>.</p><p><strong>Aging fruit fly negative mode</strong> is reported in <a href='https://www.ebi.ac.uk/metabolights/MTBLS615' rel='noopener noreferrer' target='_blank'><strong>MTBLS615</strong></a>.</p>",
                "submissionDate": "2018-01-18",
                "publicReleaseDate": "2019-03-26",
                "people": [
                    {
                        "comments": [],
                        "firstName": "Xiaotao",
                        "lastName": "Shen",
                        "email": "shenxt@sioc.ac.cn",
                        "affiliation": "Chinese Academy of Sciences",
                        "address": "26 qiuyue road, pudong, shanghai, China",
                        "fax": "",
                        "midInitials": "",
                        "phone": "+86 15821606469",
                        "roles": [
                            {
                                "comments": [],
                                "annotationValue": "Student",
                                "termSource": {
                                    "comments": [],
                                    "name": "NCIT",
                                    "file": "",
                                    "version": "",
                                    "description": ""
                                },
                                "termAccession": "http://purl.obolibrary.org/obo/NCIT_C75561"
                            }
                        ]
                    }
                ],
                "studyDesignDescriptors": [
                    {
                        "comments": [],
                        "annotationValue": "Metabolomics",
                        "termSource": {
                            "comments": [],
                            "name": "SWO",
                            "file": "http://data.bioontology.org/ontologies/SWO",
                            "version": "19",
                            "description": "Software Ontology"
                        },
                        "termAccession": "http://edamontology.org/topic_3172"
                    },
                    {
                        "comments": [],
                        "annotationValue": "MetDNA",
                        "termSource": {
                            "comments": [],
                            "name": "",
                            "file": "http://purl.obolibrary.org/obo/ncit.owl",
                            "version": "18.10e",
                            "description": "NCI Thesaurus OBO Edition"
                        },
                        "termAccession": ""
                    },
                    {
                        "comments": [],
                        "annotationValue": "method development",
                        "termSource": {
                            "comments": [],
                            "name": "",
                            "file": "http://purl.obolibrary.org/obo/ncit.owl",
                            "version": "18.10e",
                            "description": "NCI Thesaurus OBO Edition"
                        },
                        "termAccession": ""
                    },
                    {
                        "comments": [],
                        "annotationValue": "metabolite annotation",
                        "termSource": {
                            "comments": [],
                            "name": "",
                            "file": "http://purl.obolibrary.org/obo/ncit.owl",
                            "version": "18.10e",
                            "description": "NCI Thesaurus OBO Edition"
                        },
                        "termAccession": ""
                    },
                    {
                        "comments": [],
                        "annotationValue": "ultra-performance liquid chromatography-mass spectrometry",
                        "termSource": {
                            "comments": [],
                            "name": "CHMO",
                            "file": "http://data.bioontology.org/ontologies/CHMO",
                            "version": "18",
                            "description": "Chemical Methods Ontology"
                        },
                        "termAccession": "http://purl.obolibrary.org/obo/CHMO_0000715"
                    },
                    {
                        "comments": [],
                        "annotationValue": "untargeted metabolites",
                        "termSource": {
                            "comments": [],
                            "name": "",
                            "file": "http://purl.obolibrary.org/obo/ncit.owl",
                            "version": "18.10e",
                            "description": "NCI Thesaurus OBO Edition"
                        },
                        "termAccession": ""
                    }
                ],
                "publications": [
                    {
                        "comments": [],
                        "title": "Metabolic reaction network-based recursive metabolite annotation for untargeted metabolomics.",
                        "authorList": "Shen X, Wang R, Xiong X, Yin Y, Cai Y, Ma Z, Liu N, Zhu ZJ.",
                        "pubMedID": "30944337",
                        "doi": "10.1038/s41467-019-09550-x",
                        "status": {
                            "comments": [],
                            "annotationValue": "Published",
                            "termSource": {
                                "comments": [],
                                "name": "EFO",
                                "file": "",
                                "version": "",
                                "description": ""
                            },
                            "termAccession": "http://www.ebi.ac.uk/efo/EFO_0001796"
                        }
                    }
                ],
                "factors": [
                    {
                        "comments": [],
                        "factorName": "Age",
                        "factorType": {
                            "comments": [],
                            "annotationValue": "age",
                            "termSource": {
                                "comments": [],
                                "name": "BIOMODELS",
                                "file": "http://data.bioontology.org/ontologies/BIOMODELS",
                                "version": "3",
                                "description": "BioModels Ontology"
                            },
                            "termAccession": "http://purl.org/obo/owl/PATO"
                        }
                    },
                    {
                        "comments": [],
                        "factorName": "Sample type",
                        "factorType": {
                            "comments": [],
                            "annotationValue": "Sample",
                            "termSource": {
                                "comments": [],
                                "name": "ms",
                                "file": "http://purl.obolibrary.org/obo/ms.owl",
                                "version": "18-03-2019",
                                "description": "Terms to describe the sample."
                            },
                            "termAccession": "http://purl.obolibrary.org/obo/MS_1000457"
                        }
                    }
                ],
                "protocols": [
                    {
                        "comments": [],
                        "name": "Sample collection",
                        "protocolType": {
                            "comments": [],
                            "annotationValue": "Sample collection",
                            "termSource": {
                                "comments": [],
                                "name": "",
                                "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                "version": "18.10e",
                                "description": "NCI Thesaurus OBO Edition"
                            },
                            "termAccession": ""
                        },
                        "description": "<div>Wild-type male mice (C57BL/6J) were bred under standard conditions. Ten mice were euthanised by cervical dislocation at both 24 and 78 weeks. The livers of the mice were collected and placed into microcentrifuge tubes. The tubes were immediately frozen with liquid nitrogen and stored at -80 \u00b0C until metabolite extraction. <br></div><div><span style=\"color: rgb(0, 0, 0); font-family: \u5fae\u8f6f\u96c5\u9ed1, Verdana, &quot;Microsoft Yahei&quot;, SimSun, sans-serif; font-size: 14px; font-style: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; display: inline !important; float: none;\">QC samples were a pool of all the biological samples.</span></div>",
                        "uri": "",
                        "version": "",
                        "parameters": [
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Post Extraction",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Derivatization",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            }
                        ],
                        "components": []
                    },
                    {
                        "comments": [],
                        "name": "Extraction",
                        "protocolType": {
                            "comments": [],
                            "annotationValue": "Extraction",
                            "termSource": {
                                "comments": [],
                                "name": "",
                                "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                "version": "18.10e",
                                "description": "NCI Thesaurus OBO Edition"
                            },
                            "termAccession": ""
                        },
                        "description": "Mouse liver samples (~10 mg) were homogenized 3 times in 200 \u03bcl of H2O with ceramic beads using Precellys homogenizers (6,000 rpm). The homogenization takes 20 s with 5 s intervals for each time. Liquid nitrogen was used to keep the low temperature of homogenization. After homogenization, 400 \u03bcl of MeOH:ACN (1:1, v/v) was added to samples as the extraction solvent, vortexed for 30 s, and incubated in liquid nitrogen for 1 min. The samples were then allowed to thaw at room temperature, and sonicated for 10 min. This freeze-thaw cycle was repeated three times. To precipitate proteins, the samples were incubated at -20 \u00b0C for 1 h, followed by centrifugation at 13,000 rpm and 4 \u00b0C for 15 min. Then the supernatant was removed and evaporated to dryness in a vacuum concentrator. The dry extracts were then reconstituted in 100 \u00b5l of ACN:H2O (1:1, v/v), sonicated for 10 min, and centrifuged at 13,000 rpm and 4 \u00b0C for 15 min to remove insoluble debris. The supernatant was transferred to HPLC vials and stored at -80 \u00b0C prior to LC-MS analysis.",
                        "uri": "",
                        "version": "",
                        "parameters": [
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Chromatography Instrument",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Column type",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Column model",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            }
                        ],
                        "components": []
                    },
                    {
                        "comments": [],
                        "name": "Chromatography",
                        "protocolType": {
                            "comments": [],
                            "annotationValue": "Chromatography",
                            "termSource": {
                                "comments": [],
                                "name": "",
                                "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                "version": "18.10e",
                                "description": "NCI Thesaurus OBO Edition"
                            },
                            "termAccession": ""
                        },
                        "description": "The metabolomics data acquisition was performed using a UHPLC system (1290 series, Agilent Technologies, USA) coupled to a quadruple time-of-flight mass spectrometer (TripleTOF 6600, AB SCIEX, USA). Waters ACQUITY UPLC BEH Amide column (particle size, 1.7 \u03bcm; 100 mm (length) \u00d7 2.1 mm (i.d.)) was used for the LC separation and the column temperature was kept at 25 \u00b0C. Mobile phase A was 25 mM ammonium hydroxide (NH4OH) + 25 mM ammonium acetate (NH4OAc) in water and B was ACN in positive mode (ESI+) and negative mode (ESI-), respectively. The flow rate was 0.3 ml/min and the gradient was set as follows: 0-1 min: 95% B, 1-14 min: 95% B to 65% B, 14-16 min: 65% B to 40% B, 16-18 min: 40% B, 18-18.1 min: 40% B to 95% B, 18.1-23 min: 95% B.",
                        "uri": "",
                        "version": "",
                        "parameters": [
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Scan polarity",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Scan m/z range",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Chromatography Instrument",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Mass analyzer",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Ion source",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Column model",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Column type",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            }
                        ],
                        "components": []
                    },
                    {
                        "comments": [],
                        "name": "Mass spectrometry",
                        "protocolType": {
                            "comments": [],
                            "annotationValue": "Mass spectrometry",
                            "termSource": {
                                "comments": [],
                                "name": "",
                                "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                "version": "18.10e",
                                "description": "NCI Thesaurus OBO Edition"
                            },
                            "termAccession": ""
                        },
                        "description": "The metabolomics data acquisition mode was operated under information-dependent acquisition (IDA) mode. The source parameters were set as follows: ion source gas 1 (GAS1), 60 psi; ion source gas 2 (GAS2): 60 psi; curtain gas (CUR): 30 psi; temperature (TEM): 600 \u00b0C; declustering potential (DP): 60 V or -60 V in positive or negative modes, respectively; ion spray Voltage floating (ISVF): 5500 V or -4000 V in positive or negative modes, respectively. The TOF MS scan parameters were set as follows: mass range: 60-1200 Da; accumulation time: 200 ms; dynamic background subtract: check. The product ion scan parameters were set as follows: mass range: 25-1200 Da, accumulation time: 50 ms; collision energy (CE): 30 V or -30 V in positive or negative mode, respectively; collision energy spread (CES): 0; resolution: UNIT; charge state: 1 to 1; intensity: 100 cps; exclude isotopes within: 4 Da; mass tolerance: 10 ppm; maximum number of candidate ions to monitor per cycle: 6; exclude former target ions: for 4 seconds after 2 occurrences.",
                        "uri": "",
                        "version": "",
                        "parameters": [
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Instrument",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Scan polarity",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": " Scan m/z range",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Ion source",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            },
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "Mass analyzer",
                                    "termSource": {
                                        "comments": [],
                                        "name": "",
                                        "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                        "version": "18.10e",
                                        "description": "NCI Thesaurus OBO Edition"
                                    },
                                    "termAccession": ""
                                }
                            }
                        ],
                        "components": []
                    },
                    {
                        "comments": [],
                        "name": "Data transformation",
                        "protocolType": {
                            "comments": [],
                            "annotationValue": "Data transformation",
                            "termSource": {
                                "comments": [],
                                "name": "",
                                "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                "version": "18.10e",
                                "description": "NCI Thesaurus OBO Edition"
                            },
                            "termAccession": ""
                        },
                        "description": "All the MS raw data (.wiff) files were converted to mzXML format and mgf format using ProteoWizard (version 3.0.6150, http://proteowizard.sourceforge.net/). The detailed parameters for mzXML and mgf format conversion are listed in the Supplementary section of the associated study paper to reproduce our results. Then the mzXML data were processed using R package \u201cXCMS\u201d (version 1.46.0,  https://bioconductor.org/packages/3.2/bioc/html/xcms.html). The detailed code for XCMS processing is provide in Supplementary section also. The final processing result generated a data matrix that consisted of the retention time (RT), mass-to-charge ratio (m/z) values and peak abundance. The 1st column, \u201cname\u201d, is the name of metabolic peaks; the 2nd column, \u201cmz\u201d, is the mass to charge ratio of metabolic peaks; the 3rd column, \u201crt\u201d, is the retention time (second) of metabolic peaks; and remaining columns are abundance of subject samples (see the help document of MetDNA at http://metdna.zhulab.cn/help).",
                        "uri": "",
                        "version": "",
                        "parameters": [
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "",
                                    "termSource": null,
                                    "termAccession": ""
                                }
                            }
                        ],
                        "components": []
                    },
                    {
                        "comments": [],
                        "name": "Metabolite identification",
                        "protocolType": {
                            "comments": [],
                            "annotationValue": "Metabolite identification",
                            "termSource": {
                                "comments": [],
                                "name": "",
                                "file": "http://purl.obolibrary.org/obo/ncit.owl",
                                "version": "18.10e",
                                "description": "NCI Thesaurus OBO Edition"
                            },
                            "termAccession": ""
                        },
                        "description": "<div><i>Annotation of initial seed metabolites </i><br></div><div>With the imported MS1 peak table and MS2 data, MetDNA first matches the MS1 peaks with MS2 spectra according to their m/z (\u00b1 25 ppm) and RT (\u00b1 10 s) values. If one MS1 peak matches multiple MS2 spectra, the most abundant MS2 spectrum is selected. In MetDNA, the intensities of the top 10 abundant fragment ions are summed up to represent the abundance of MS2 spectra. If one uses MS-DIAL for the peak picking and outputting MS2 data (.msp format), then the MS1-MS2 match step is skipped by MetDNA. The generated MS1/MS2 pairs are matched with our in-house standard spectral library for metabolite annotation. The match tolerance for the MS1 m/z value is set as \u00b1 25 ppm. We compared four different scoring methods to evaluate MS2 spectra similarity (see Supplementary Note 1), and found that dot product score is an appropriate one. So the modified dot product (DP) function is used to score the similarity between the experimental spectrum and the standard spectrum in the library (eq. 1). The DP score ranges from 0-1, from no match to a perfect match. The intensities of the fragment ions in the MS2 spectra are rescaled so that the highest fragment ion is set to 1. <br></div><div> (eq.  1) &nbsp;&nbsp;<b> <style> <!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --> </style> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">Dot product = </span> \u2211 </b><style><b> &lt;!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --&gt; </b></style><b> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">W<sub>S</sub>W<sub>E</sub></span> / \u221a\u2211 </b><style><b> &lt;!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --&gt; </b></style><b> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">W<sub>S</sub><sup>2</sup>W<sub>E</sub><sup>2</sup></span></b> </div><div>where weighted intensity vector, W = [relative intensity of fragment ion] <style> <!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --> </style> <sup><span style=\"font-size:10.0pt;font-family: &quot;Arial&quot;,sans-serif;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language: EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA\" lang=\"EN-US\">n</span></sup> [m/z value]&nbsp; <style> <!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;}\u00a0\u00a0</style><sup><span style=\"font-size:10.0pt;font-family: &quot;Arial&quot;,sans-serif;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language: EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA\" lang=\"EN-US\">m</span></sup> , n = 1, m = 0; S = standard, and E = experiment. DP scores from both forward and reverse matches are generated. Metabolite annotations with DP scores in either forward or reverse matches larger than 0.8 are kept. Usually, 50-200 metabolites are annotated using the standard spectral library. The annotations are further filtered using the theoretical RTs of the metabolites (\u00b1 30%). The generation of the theoretical RTs is provided below. The remaining annotations are used as initial seed metabolites in round 0 for MRN-based recursive annotation. The seed metabolites are defined as the annotated metabolites that provide their MS2 spectra as surrogate MS2 spectra for the annotation of their reaction-paired neighbor metabolites. <br></div><div><br></div><div> <i>Annotation of isotope and adduct peaks </i><br></div><div>First, the isotope peaks of seed metabolites are annotated by MetDNA. For each seed metabolite, the program calculates the theoretical m/z and the relative intensities of isotope peaks from the formula using the binomial and McLaurin expansion (R package Rdisop). Only four isotope peaks ([M] to [M+4]) are calculated. The generated isotope peaks of seed metabolites are used to match all the MS1 peaks in the MS1 peak table according to the m/z, RT and relative intensity. The default tolerances for the m/z, RT and relative intensity are set as \u00b1 25 ppm, \u00b1 3 s, and \u00b1 500%, respectively. The large tolerance for the relative intensity match is due to the inaccuracy of the experimental intensity ratios for the isotope peaks.  The matched isotope peaks are assigned the annotation scores (<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt; line-height:150%;font-family:&quot;Arial&quot;,sans-serif\"></span></span></span></span></span><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt; line-height:150%;font-family:&quot;Arial&quot;,sans-serif\"><sub>iso</sub></span></span></span><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt; line-height:150%;font-family:&quot;Arial&quot;,sans-serif\"></span></span></span>) shown below. <br></div><div>(eq. 2) &nbsp;&nbsp; <style> <!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --></style><b><span style=\"font-size:10.0pt; line-height:150%;font-family:&quot;Arial&quot;,sans-serif\">Score<sub>iso</sub> = Score<sub>m/z</sub>W<sub>m/z</sub> + Score<sub>RT</sub>W<sub>RT</sub> + Score<sub>int</sub>W<sub>int</sub></span></b><style></style> </div><div>where Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt; line-height:150%;font-family:&quot;Arial&quot;,sans-serif\"><sub>m/z</sub></span></span></span> represents the m/z match score and is calculated as follows: <br></div><div>(eq. 3) &nbsp;&nbsp; <b> </b><style><b> &lt;!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --&gt; </b></style><b> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">Score<sub>m/z </sub>= 1- (|(mz<sub>E </sub>- mz<sub>T</sub>) * 10<sup>6</sup>/mz<sub>T</sub>|) / Tolerance<sub>m/z</sub></span></b> </div><div> <style> <!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} -->\u00a0</style><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">mz<span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>E</sub></span></span></span><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><b><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"></span></b></span></span> and mz<style><!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} -\u00a0</style><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>T</sub></span> are the experimental m/z and theoretical m/z, respectively.  The Tolerance<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>M/Z</sub></span></span></span> represents the tolerance for the m/z match with a default value of 25 ppm.  Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language:\nEN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span> represents the retention time match score and is calculated as follows: (eq.4)&nbsp; &nbsp;<b> </b><style><b> &lt;!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --&gt; </b></style><b> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">Score<sub>RT </sub>= 1- (|RT<sub>E </sub>- RT<sub>T</sub>|) / Tolerance<sub>m/z</sub></span></b> </div><div> RT<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>E</sub></span></span></span><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><b><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"></span></b></span></span></span></span> and RT<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>T</sub></span></span></span><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"></span></span></span> are the experimental RT and theoretical RT, respectively.  The Toleranc<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">e<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span> represents the tolerance of RT match with a default value of 3 seconds.  Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>int</sub></span></span></span></span></span> represents the relative intensity match score and is calculated as follows: <br></div><div>(eq.5)&nbsp; &nbsp; <b> </b><style><b> &lt;!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --&gt; </b></style><b> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">Score<sub>int </sub>= 1- (|Int<sub>E </sub>- Int<sub>T</sub>) * 100/Int<sub>T</sub>|) <span style=\"mso-spacerun:yes\">&nbsp;</span>/ Tolerance<sub>int</sub></span></b> </div><div> Int<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>E</sub></span></span></span></span></span> and <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">Int<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>T</sub></span></span></span></span></span></span></span> are the experimental relative intensity and theoretical relative intensity, respectively. The Tolerance<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>int</sub></span></span></span></span></span></span></span> represents the relative intensity match tolerance with a default value of 500%.  W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>m/z</sub></span></span></span></span></span></span></span>, <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span> and <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>int</sub></span></span></span></span></span></span></span></span></span> represent the weights of Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>m/z</sub></span></span></span></span></span></span></span></span></span>, Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span> and Scor<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">e<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>int</sub></span></span></span></span></span></span></span></span></span>, respectively, and the default values are 0.45, 0.45 and 0.1, respectively.  Second, MetDNA calculates the possible m/z values for the adduct peaks of seed metabolites. The adduct table for different LC separations (HILIC or RP) and polarities (positive and negative) are listed in Supplementary Table 5 of the associated study paper. All the possible adduct peaks of the seed metabolites are then matched to the MS1 peak table according to their m/z and RT. The default tolerances for the m/z and RT are \u00b1 25 ppm and \u00b1 3 s, respectively. The annotations of the adduct peaks are also assigned annotation scores (Scoreadduct) as follows. <br></div><div>(eq. 6) &nbsp;&nbsp; <b> </b><style><b> &lt;!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --&gt; </b></style><b> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">Score<sub>adduct</sub> = Score<sub>m/z</sub>W<sub>m/z</sub> + Score<sub>RT</sub>W<sub>RT</sub></span></b> </div><div>where Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>m/z</sub></span></span></span></span></span></span></span></span></span> represents the m/z match score and is calculated as indicated in eq. 3. Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span> represents the retention time match score and is calculated using eq. 4. <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>m/z</sub></span></span></span></span></span></span></span></span></span> and <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span> represent the weights of Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>m/z</sub></span></span></span></span></span></span></span></span></span> and Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span>, respectively, and the default values are 0.8, and 0.2, respectively. <br></div><div>Third, after the annotation of the adduct peak, the isotope peak annotation for each adduct peak is also performed using the same procedures described above.</div><div>The annotation of in-source fragmentation is not included in MetDNA. But some in-source fragmentations can be well differentiated using the RT. For example, RTs for tryptamine and tryptophan are 325.1 s and 446.7 s, respectively, which generate a RT error of 37.2%. In MetDNA, true tryptamine and tryptamine from the in-source fragmentation can be well differentiated using the RTs.  &nbsp; <br></div><div><br> </div><div><i>Annotation of reaction-paired neighbor metabolites </i><br></div><div>Two metabolites in one reaction pair are neighbor metabolites. The seed metabolites provide their experimental MS2 spectra as surrogate spectra to annotate their neighbor metabolites. First, the initial seed metabolites are mapped to MRN and retrieve their neighbor metabolites from MRN. The reaction step is defined as the number of reactions between two metabolites. All the neighbor metabolites with 1 reaction step are retrieved. The MS2 spectra of the seed metabolites are assigned to their corresponding neighbor metabolites as surrogate MS2 spectra.  The precursor m/z was calculated for the neighbor metabolites according to the possible adduct (such as [M+H]+ or [M+Na]+) in the LC condition (HILIC or RP) and ionization polarity. In addition, RTs for the neighbor metabolites were also predicted.  For each neighbor metabolite, the generated theoretical m/z, predicted RT (from RT prediction) and surrogate MS2 spectrum are matched to the experimental MS1 m/z (default tolerance: \u00b1 25 ppm), RT (default tolerance: \u00b1 30%), and MS2 spectrum (default tolerance: 0.5). If one seed metabolite leads to no annotation of a neighbor metabolite with 1 reaction step, then neighbor metabolites with 2 reaction steps are further retrieved. The default value of the maximum reaction step is 3. The annotations of neighbor metabolites are assigned the annotation scores shown below. <br></div><div>(eq. 7) &nbsp;&nbsp;<b> </b><style><b> &lt;!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --&gt; </b></style><b> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">Score<sub>iden</sub> = Score<sub>m/z</sub>W<sub>m/z</sub> + Score<sub>RT</sub>W<sub>RT</sub> + Score<sub>spec</sub>W<sub>spec</sub></span></b> </div><div>where Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>m/z</sub></span></span></span></span></span></span></span></span></span>, <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>m/z</sub></span></span></span></span></span></span></span></span></span> and <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span> are the same as in eq. 2. Score<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span> is calculated as follows: <br></div><div>(eq.8)&nbsp; &nbsp;<b> </b><style><b> &lt;!-- /* Font Definitions */ @font-face {font-family:\"Cambria Math\"; panose-1:2 4 5 3 5 4 6 3 2 4; mso-font-charset:0; mso-generic-font-family:roman; mso-font-pitch:variable; mso-font-signature:-536870145 1107305727 0 0 415 0;} /* Style Definitions */ p.MsoNormal, li.MsoNormal, div.MsoNormal {mso-style-unhide:no; mso-style-qformat:yes; mso-style-parent:\"\"; margin:0cm; margin-bottom:.0001pt; mso-pagination:widow-orphan; font-size:12.0pt; font-family:\"Times New Roman\",serif; mso-fareast-font-family:\"Times New Roman\";} .MsoChpDefault {mso-style-type:export-only; mso-default-props:yes; font-family:\"Calibri\",sans-serif; mso-ascii-font-family:Calibri; mso-ascii-theme-font:minor-latin; mso-fareast-font-family:Calibri; mso-fareast-theme-font:minor-latin; mso-hansi-font-family:Calibri; mso-hansi-theme-font:minor-latin; mso-bidi-font-family:\"Times New Roman\"; mso-bidi-theme-font:minor-bidi;} @page WordSection1 {size:612.0pt 792.0pt; margin:72.0pt 72.0pt 72.0pt 72.0pt; mso-header-margin:36.0pt; mso-footer-margin:36.0pt; mso-paper-source:0;} div.WordSection1 {page:WordSection1;} --&gt; </b></style><b> <span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\">Score<sub>RT </sub>= 1- (|RT<sub>E </sub>- RT<sub>T</sub>) * 100/RT<sub>T</sub>|) <span style=\"mso-spacerun:yes\">&nbsp;</span>/ Tolerance<sub>RT</sub></span></b> </div><div><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">RT<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>E</sub></span></span></span></span></span></span></span></span></span> and <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">RT<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>T</sub></span></span></span></span></span></span></span></span></span></span></span> are the experimental RT and theoretical RT, respectively.  The Tolerance<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span></span></span> represents the tolerance of RT match with a default value of 30%.  Scorespec is the MS2 spectral match score, which is scored using a dot-product function (eq. 1) with some modifications. If the m/z value of seed metabolite is larger than the neighbor metabolite, the fragment ions in the surrogate MS2 spectrum with m/z larger than that of the neighbor metabolite are removed. Vice versa, the fragment ions in the experimental MS2 spectrum with m/z larger than that of seed metabolite are also removed. Wspec is the weight of Scorespec.  The default values of W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>m/z</sub></span></span></span></span></span></span></span></span></span></span></span>, <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>RT</sub></span></span></span></span></span></span></span></span></span></span></span></span></span> and <span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\">W<span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span _ngcontent-c15=\"\" class=\"ng-star-inserted\"><span _ngcontent-c32=\"\" class=\"ng-star-inserted\"><span style=\"font-size:10.0pt;font-family:&quot;Arial&quot;,sans-serif; mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-GB;mso-fareast-language: EN-US;mso-bidi-language:AR-SA\"><sub>spec</sub></span></span></span></span></span></span></span></span></span></span></span></span></span> are 0.25, 0.25 and 0.5, respectively. The annotations of each MS1 peak are ranked by Scoreiden. After the annotation of neighbor metabolites, isotope peak annotation is also performed for each neighbor metabolite using the same procedures described above.  &nbsp; <br></div><div><i><br></i></div><div><i>Selection of seed metabolites and recursive annotation </i><br></div><div>After one round of annotation, new seed metabolites are selected from the annotated neighbor metabolites to start recursive annotation. Peaks with new annotations are selected as seed metabolites. MetDNA then repeats the neighbor metabolite identification and isotope peak annotation until there are no new seed metabolites available for the next round of annotation.  &nbsp; <br></div><div><br></div><div><i>Confidence assignment </i><br></div><div> MetDNA uses a multi-step strategy to evaluate the confidence of the metabolite annotation. First, all the annotated MS1 peaks are grouped according to their annotation and RT. The MS1 peaks with the same metabolite annotations are grouped together and further divided into different peak groups according to their RT. The peak group is defined as a set of peaks (e.g., monoisotope peak, isotope peaks, and adduct peaks) with the same annotation and in the same RT window (default is 3 seconds). If one peak has multiple annotations, it may belong to multiple peak groups. Similarly, one metabolite may also belong to multiple peak groups. The confidence is then assigned to each peak group and all MS1 peaks in the group according to the following rules: <br></div><div>1)&nbsp;&nbsp;&nbsp;&nbsp; Grade 1: at least one MS1 peak in the peak group is annotated through the standard spectral library (or initial seed metabolite); <br></div><div>2)&nbsp;&nbsp;&nbsp;&nbsp; Grade 2: do not meet rule 1, and there are isotope peaks available in the peak group; <br></div><div>3)&nbsp;&nbsp;&nbsp;&nbsp; Grade 3: do not meet rules 1 and 2, and there are reliable adduct peaks in the peak group, such as [M+H]+, [M+Na]+ or [M+NH4]+ for positive mode, and [M-H]-, [M+Cl]- or [M+CH3COO]- for negative mode, respectively; and <br></div><div> 4)&nbsp;&nbsp;&nbsp;&nbsp; Grade 4: the remaining peak groups that do not meet rules 1, 2, or 3.  &nbsp; <br></div><div><br></div><div><i>Redundancy removal </i><br></div><div>Annotation redundancy includes peak redundancy and metabolite redundancy. Peak redundancy is defined as the total number of metabolite annotations divided by the total number of peaks with annotations, that is, the number of metabolites per peak.  By contrast, the metabolite redundancy is defined as the total number of peak groups with annotation divided by the total number of metabolite annotations, that is, the number of peak groups per metabolite. MetDNA then removes the annotation redundancy according to the confidence levels of the peak group and the peaks in the group. First, if one metabolite matches multiple peak groups, the program removes the annotation from all the peaks in the peak groups with grade 4. However, if all of the matched peak groups are grade 4, all the annotations are maintained. Second, if one peak matches multiple metabolites, the annotations with the highest grade are kept. After the removal of the annotation redundancy, the constitution of the peak groups may change. The confidence assignment is then repeated, followed by a repetition of the redundancy removal process, which is also a recursive process. The recursive process continues until the annotation redundancy remains unchanged. The annotation redundancy is calculated as the mean value of the peak redundancy and the metabolite redundancy.  &nbsp; <br></div><div><i><br></i></div><div><i>Validation of accuracy </i><br></div><div>We systematically compared the annotation results from the same biological samples between MetDNA and other approaches. Each validation experiment represented different confidence levels and different sizes of chemical search space. For the first experiment, a total of 200 (167 metabolites included in MRN) chemical standards were added into mouse liver samples as spike-in. Manual analysis of the experimental data with the comparison to the data of chemical standards (m/z, RT, and MS2 spectra) demonstrated that 113 and 137 metabolites were detected and identified in positive and negative modes, respectively, which were considered as the level 1 identification according to MSI. As a comparison, MetDNA successfully annotated 89 out of 113 (78.8%) and 113 out of 137 (82.5%) metabolites in positive and negative modes, respectively, indicating a high annotation coverage. All the MS2 spectra of 200 standards were intentionally removed from the standard spectral library, therefore, excluding them as the initial seed metabolites. Compared to chemical standards, we divided MetDNA annotation results into three categories: correct, isomeric and erroneous annotations among top n ranked candidates, which is similar to other metabolite annotation tools. In our study, top 3 candidates were used to evaluate the performance of annotation except the specific statement. In MetDNA output for positive mode, the percentage of the correct annotation was 77.5% among top 3 candidates, whereas isomer and erroneous annotations were only 12.4% and 10.1% among top 3 candidates, respectively. <br></div><div>For the second validation experiment, we first confirmed the structures of 107 seed metabolites using chemical standards in positive mode of the Drosophila aging dataset, which were also considered as the MSI level 1 identification. We randomly chose 30% of the metabolites as seeds, and asked whether MetDNA could correctly annotate the rest 70% metabolites. This experiment has been repeated 10 times. As a result, a coverage of 90.9% of metabolites could be successfully annotated, which means that 90.9% of metabolites can be annotated by MetDNA. For the annotated metabolites, the percentages for the correct, isomeric, and erroneous annotations among top 3 candidates were 81.1%, 6.3% and 12.6%, respectively.  Similar results were also obtained for negative mode of Drosophila and Escherichia coli datasets. <br></div><div>For the third validation experiment, we employed the external NIST17 and MassBank [http://www.massbank.jp] spectral databases. As noted, there are 2,608 and 1,464 metabolites in NIST and MassBank acquired on Q-TOF instruments, respectively. A total of 279 and 206 metabolites were identified from two spectral databases in positive and negative modes, respectively. The low ratio may be due to the insufficient measurement of metabolites in libraries on the particular LC-MS condition, or uncharacterized spectral variations across different LC-MS instruments and laboratories (i.e., between the experimental data and library data).Consistently, MetDNA successfully annotated 156 out of 279 (55.9%) and 128 out of 206 (62.1%) metabolites in positive and negative modes, respectively. The percentage for the correct annotation among top 3 candidates was 74.0%, whereas isomer and erroneous annotations were about 4.5% and 21.5%, respectively. Collectively, these validation experiments demonstrated that the overall performance of MetDNA attains approximately 70-80% for correct annotations among top 3 candidates and 80-90% for correct formula annotation (correct and isomer) among top 3 candidates. In addition, the correct annotation rate among top 3 candidates should be considered as true positive rate, which was 70-80% in different validation experiments. Meanwhile, the erroneous annotation among top 3 candidates rate should be considered as the false positive rate, which was 10-20% in different validation experiments.  </div>",
                        "uri": "",
                        "version": "",
                        "parameters": [
                            {
                                "comments": [],
                                "parameterName": {
                                    "comments": [],
                                    "annotationValue": "",
                                    "termSource": null,
                                    "termAccession": ""
                                }
                            }
                        ],
                        "components": []
                    }
                ],
                "assays": [
                    {
                        "comments": [],
                        "measurementType": {
                            "comments": [],
                            "annotationValue": "metabolite profiling",
                            "termSource": {
                                "comments": [],
                                "name": "OBI",
                                "file": "http://data.bioontology.org/ontologies/OBI",
                                "version": "22",
                                "description": "Ontology for Biomedical Investigations"
                            },
                            "termAccession": "http://purl.obolibrary.org/obo/OBI_0000366"
                        },
                        "technologyType": {
                            "comments": [],
                            "annotationValue": "mass spectrometry",
                            "termSource": {
                                "comments": [],
                                "name": "OBI",
                                "file": "http://data.bioontology.org/ontologies/OBI",
                                "version": "22",
                                "description": "Ontology for Biomedical Investigations"
                            },
                            "termAccession": "http://purl.obolibrary.org/obo/OBI_0000470"
                        },
                        "technologyPlatform": "TripleTOF 6600 (AB sciex)",
                        "filename": "a_MTBLS601_aging_mouse_liver_pos_metabolite_profiling_mass_spectrometry.txt",
                        "dataFiles": [],
                        "processSequence": [],
                        "sources": [],
                        "samples": [],
                        "otherMaterials": [],
                        "characteristicCategories": [],
                        "units": [],
                        "graph": null
                    }
                ],
                "sources": [],
                "samples": [],
                "processSequence": [],
                "characteristicCategories": [],
                "units": []
            }
        ]
    },
    "validation": {
        "errors": [],
        "warnings": []
    }
}